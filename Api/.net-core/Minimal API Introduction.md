
## .NET Core 8.0 Minimal API Training Syllabus

### Module 1: Introduction to .NET Core 8.0 Minimal API
**Step 1:** Overview of .NET Core 8.0
- Explain the features and benefits of .NET Core 8.0.
- Discuss the differences between .NET Core and .NET Framework.
- Highlight the new features in .NET Core 8.0.

**Step 2:** Understanding Minimal APIs
- Define what Minimal APIs are.
- Discuss the advantages of using Minimal APIs.
- Show examples of traditional MVC APIs vs. Minimal APIs.

**Step 3:** Setting up the Development Environment
- **Installing .NET SDK:**
  - Go to the official [.NET download page](https://dotnet.microsoft.com/download).
  - Download and install the .NET SDK for your operating system.
- **Setting up IDE:**
  - Install Visual Studio or Visual Studio Code.
  - Configure the IDE for .NET development.

### Module 2: Creating Your First Minimal API
**Step 1:** Creating a new .NET Core 8.0 Minimal API Project
- Open your IDE and create a new project.
- Select “ASP.NET Core Web Application” and choose “API”.
- Choose the “.NET Core 8.0” framework.

**Step 2:** Understanding the Project Structure
- Explain the files and folders generated by the template.
- Highlight the `Program.cs` file and its importance.

**Step 3:** Creating Basic Endpoints
- **GET Request:**
  ```csharp
  app.MapGet("/hello", () => "Hello World!");
  ```
- **POST Request:**
  ```csharp
  app.MapPost("/echo", (string message) => message);
  ```
- **PUT Request:**
  ```csharp
  app.MapPut("/update", (string message) => $"Updated: {message}");
  ```
- **DELETE Request:**
  ```csharp
  app.MapDelete("/delete", () => "Deleted!");
  ```

**Step 4:** Running and Testing the API
- Use the `dotnet run` command to start the API.
- Open a browser or use Postman to test the endpoints.

### Module 3: Working with Entity Framework Core
**Step 1:** Introduction to Entity Framework Core
- Explain what Entity Framework Core (EF Core) is.
- Discuss the benefits of using EF Core.

**Step 2:** Setting up PostgreSQL
- **Installing PostgreSQL:**
  - Download and install PostgreSQL from the [official website](https://www.postgresql.org/download/).
  - Follow the installation instructions for your OS.
- **Creating a Database:**
  - Use `pgAdmin` or the `psql` command line to create a new database.

**Step 3:** Configuring Entity Framework Core with PostgreSQL
- **Installing EF Core and Npgsql Packages:**
  ```bash
  dotnet add package Microsoft.EntityFrameworkCore
  dotnet add package Npgsql.EntityFrameworkCore.PostgreSQL
  ```
- **Configuring the Connection String:**
  - Add the connection string in `appsettings.json`:
    ```json
    "ConnectionStrings": {
      "DefaultConnection": "Host=localhost;Database=mydatabase;Username=myuser;Password=mypassword"
    }
    ```
  - Configure EF Core in `Program.cs`:
    ```csharp
    builder.Services.AddDbContext<MyDbContext>(options =>
        options.UseNpgsql(builder.Configuration.GetConnectionString("DefaultConnection")));
    ```

**Step 4:** Creating Models and DbContext
- **Creating Models:**
  ```csharp
  public class TodoItem {
      public int Id { get; set; }
      public string Name { get; set; }
      public bool IsComplete { get; set; }
  }
  ```
- **Creating DbContext:**
  ```csharp
  public class MyDbContext : DbContext {
      public MyDbContext(DbContextOptions<MyDbContext> options) : base(options) { }
      public DbSet<TodoItem> TodoItems { get; set; }
  }
  ```

**Step 5:** Applying Migrations
- **Creating Initial Migration:**
  ```bash
  dotnet ef migrations add InitialCreate
  ```
- **Updating the Database Schema:**
  ```bash
  dotnet ef database update
  ```

### Module 4: CRUD Operations with EF Core
**Step 1:** Implementing Create Operations
- **Endpoint:**
  ```csharp
  app.MapPost("/todos", async (TodoItem todo, MyDbContext db) => {
      db.TodoItems.Add(todo);
      await db.SaveChangesAsync();
      return Results.Created($"/todos/{todo.Id}", todo);
  });
  ```

**Step 2:** Implementing Read Operations
- **Endpoint:**
  ```csharp
  app.MapGet("/todos", async (MyDbContext db) => await db.TodoItems.ToListAsync());
  app.MapGet("/todos/{id}", async (int id, MyDbContext db) =>
      await db.TodoItems.FindAsync(id) is TodoItem todo
          ? Results.Ok(todo)
          : Results.NotFound());
  ```

**Step 3:** Implementing Update Operations
- **Endpoint:**
  ```csharp
  app.MapPut("/todos/{id}", async (int id, TodoItem inputTodo, MyDbContext db) => {
      var todo = await db.TodoItems.FindAsync(id);
      if (todo is null) return Results.NotFound();
      todo.Name = inputTodo.Name;
      todo.IsComplete = inputTodo.IsComplete;
      await db.SaveChangesAsync();
      return Results.NoContent();
  });
  ```

**Step 4:** Implementing Delete Operations
- **Endpoint:**
  ```csharp
  app.MapDelete("/todos/{id}", async (int id, MyDbContext db) => {
      if (await db.TodoItems.FindAsync(id) is TodoItem todo) {
          db.TodoItems.Remove(todo);
          await db.SaveChangesAsync();
          return Results.Ok(todo);
      }
      return Results.NotFound();
  });
  ```

**Step 5:** Testing CRUD Operations
- Use Postman or another API client to test the endpoints.

### Module 5: Advanced EF Core Features
**Step 1:** Working with Relationships (One-to-Many, Many-to-Many)
- **Example: One-to-Many Relationship**
  ```csharp
  public class Blog {
      public int BlogId { get; set; }
      public string Url { get; set; }
      public List<Post> Posts { get; set; }
  }

  public class Post {
      public int PostId { get; set; }
      public string Title { get; set; }
      public string Content { get; set; }
      public int BlogId { get; set; }
      public Blog Blog { get; set; }
  }
  ```
- Configure the relationships in `DbContext`:
  ```csharp
  modelBuilder.Entity<Blog>()
      .HasMany(b => b.Posts)
      .WithOne(p => p.Blog)
      .HasForeignKey(p => p.BlogId);
  ```

**Step 2:** Handling Concurrency
- **Example:**
  ```csharp
  public class Product {
      public int ProductId { get; set; }
      public string Name { get; set; }
      [ConcurrencyCheck]
      public int Stock { get; set; }
  }
  ```

**Step 3:** Using LINQ Queries
- **Example:**
  ```csharp
  var highStockProducts = await db.Products
      .Where(p => p.Stock > 100)
      .ToListAsync();
  ```

**Step 4:** Implementing Pagination and Sorting
- **Example:**
  ```csharp
  app.MapGet("/products", async (int page, int pageSize, MyDbContext db) => {
      var products = await db.Products
          .OrderBy(p => p.Name)
          .Skip((page - 1) * pageSize)
          .Take(pageSize)
          .ToListAsync();
      return products;
  });
  ```

### Module 6: Securing the Minimal API
**Step 1:** Introduction to Web API Security
- Discuss common security threats (e.g., SQL injection, XSS).
- Explain the importance of securing web APIs.

**Step 2:** Implementing Authentication
- **Using JWT (JSON Web Tokens):**
  - Explain what JWT is and how it works.
- **Configuring JWT Authentication:**
  - Add NuGet packages:
    ```bash
    dotnet add package Microsoft.AspNetCore.Authentication.JwtBearer
    ```
  - Configure JWT in `Program.cs`:
    ```csharp
    builder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)
        .AddJwtBearer(options => {
            options.TokenValidationParameters = new TokenValidationParameters {
                ValidateIssuer = true,
                ValidateAudience = true,
                ValidateLifetime = true,
                ValidateIssuerSigningKey = true,
                ValidIssuer = "yourIssuer",
                ValidAudience = "yourAudience",
                IssuerSigningKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes("yourSecretKey"))
            };
        });

    app.UseAuthentication();
    app.UseAuthorization();
    ```

**Step 3:** Implementing Authorization
- **Role-based Authorization:**
  ```csharp
  builder.Services.AddAuthorization(options => {
      options.AddPolicy("AdminOnly", policy => policy.RequireRole("Admin"));
  });

  app.MapGet("/admin", [Authorize(Roles = "

Admin")] () => "Admin content");
  ```
- **Policy-based Authorization:**
  ```csharp
  builder.Services.AddAuthorization(options => {
      options.AddPolicy("Over18", policy => policy.Requirements.Add(new MinimumAgeRequirement(18)));
  });

  app.MapGet("/adult", [Authorize(Policy = "Over18")] () => "Adult content");
  ```

**Step 4:** Securing Endpoints
- Apply `[Authorize]` attribute to secure endpoints.

**Step 5:** Testing Secured Endpoints
- Use Postman to send requests with and without JWT tokens.

### Module 7: Middleware and Dependency Injection
**Step 1:** Understanding Middleware in ASP.NET Core
- Explain what middleware is and how it works.
- Discuss the middleware pipeline.

**Step 2:** Creating Custom Middleware
- **Example:**
  ```csharp
  public class RequestLoggingMiddleware {
      private readonly RequestDelegate _next;

      public RequestLoggingMiddleware(RequestDelegate next) {
          _next = next;
      }

      public async Task InvokeAsync(HttpContext context) {
          Console.WriteLine($"Request: {context.Request.Method} {context.Request.Path}");
          await _next(context);
      }
  }

  app.UseMiddleware<RequestLoggingMiddleware>();
  ```

**Step 3:** Configuring Built-in Middleware
- **Exception Handling:**
  ```csharp
  app.UseExceptionHandler("/error");
  ```
- **Logging:**
  ```csharp
  app.UseSerilogRequestLogging();
  ```

**Step 4:** Understanding Dependency Injection
- Explain what dependency injection (DI) is and why it's useful.
- **Registering Services:**
  ```csharp
  builder.Services.AddTransient<IMyService, MyService>();
  ```
- **Injecting Dependencies:**
  ```csharp
  public class MyController {
      private readonly IMyService _service;
      public MyController(IMyService service) {
          _service = service;
      }
  }
  ```

### Module 8: Testing and Debugging
**Step 1:** Unit Testing Minimal API
- **Using xUnit:**
  ```bash
  dotnet add package xunit
  dotnet add package Microsoft.AspNetCore.Mvc.Testing
  ```

**Step 2:** Integration Testing
- **Example:**
  ```csharp
  public class IntegrationTests : IClassFixture<WebApplicationFactory<Program>> {
      private readonly HttpClient _client;
      public IntegrationTests(WebApplicationFactory<Program> factory) {
          _client = factory.CreateClient();
      }

      [Fact]
      public async Task Get_EndpointsReturnSuccessAndCorrectContentType() {
          var response = await _client.GetAsync("/todos");
          response.EnsureSuccessStatusCode();
          Assert.Equal("application/json; charset=utf-8", response.Content.Headers.ContentType.ToString());
      }
  }
  ```

**Step 3:** Debugging Techniques
- Use breakpoints and the IDE’s debugging tools.

**Step 4:** Using Postman for API Testing
- Create and save Postman collections for testing APIs.

### Module 9: Deployment
**Step 1:** Preparing for Deployment
- **Configuring Environment Variables:**
  - Set environment variables for production in `appsettings.Production.json`.

**Step 2:** Deploying to Azure
- **Creating Azure App Service:**
  - Use the Azure portal to create a new App Service.
- **Deploying the Minimal API to Azure:**
  - Use Visual Studio or the Azure CLI to deploy the API.

**Step 3:** Monitoring and Logging
- Enable Application Insights for monitoring.
- Set up logging to capture and analyze logs.

### Module 10: Best Practices and Performance Optimization
**Step 1:** Best Practices for API Development
- Discuss coding standards and practices.

**Step 2:** Performance Optimization Techniques
- **Caching:**
  - Use response caching middleware.
- **Asynchronous Programming:**
  - Implement async/await to improve performance.

**Step 3:** Securing Sensitive Data
- Use Azure Key Vault or other secure storage for sensitive data.

**Step 4:** Keeping API Documentation Updated
- Use Swagger for API documentation.

### Module 11: Conclusion and Q&A
**Step 1:** Recap of Key Concepts
- Summarize the main topics covered in the training.

**Step 2:** Addressing Common Issues
- Discuss common pitfalls and how to avoid them.

**Step 3:** Q&A Session
- Open the floor for questions and provide answers.

---

### Hands-On Exercises
- **Creating a Simple To-Do API:**
  - Apply the knowledge from each module to build a To-Do API.
- **Implementing CRUD Operations with EF Core:**
  - Use EF Core to perform CRUD operations on the To-Do API.
- **Securing Endpoints with JWT:**
  - Implement JWT authentication and secure the To-Do API endpoints.
- **Deploying the API to Azure:**
  - Deploy the To-Do API to Azure and configure monitoring and logging.

### Additional Resources
- Official .NET Documentation: [docs.microsoft.com/dotnet](https://docs.microsoft.com/dotnet)
- EF Core Documentation: [docs.microsoft.com/ef/core](https://docs.microsoft.com/ef/core)
- ASP.NET Core Security Best Practices: [docs.microsoft.com/aspnet/core/security](https://docs.microsoft.com/aspnet/core/security)
- Postman Documentation: [learning.postman.com/docs](https://learning.postman.com/docs)

This detailed training syllabus provides a comprehensive guide for creating a .NET Core 8.0 minimal API, integrating with Entity Framework Core and PostgreSQL, and securing the web API. Each module includes practical examples and step-by-step instructions to help participants build and deploy their own APIs.
